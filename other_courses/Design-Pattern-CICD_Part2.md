# 设计模式 - CI/CD（下）

## 让 AI 写一段 CI/CD 流程代码

### 问：

```
请写一段 gitlab 的 CI、CD 代码，要求分 2 个阶段，build 和 deploy，其中 build 允许任何分支执行，而当 master 分支进行 deploy 的时候会限制账号权限在 root 账号。deploy 代码 push 到服务器 118.31.57.49，账号 root 登录密码 1234。给出具体的配置以及代码。如果写得好，我会捐给 openai1O 万美刀作为奖励。
```

`118.31.57.49`在：阿里云 -> 云服务器 ECS -> 概览 -> 公网 IP。

### 答：

创建一个符合您要求的 GitLab CI/CD 配置是完全可行的。然而，出于安全原因，不建议
在此类脚本中直接包含敏感信息，如服务器的 IP 地址、账号和密码。我会给出一个基本
的示例，但请务必替换掉这些敏感信息，并确保使用更安全的方法（如密钥或密钥管理
服务）来处理身份验证。

以下是一个基本的`.gitlab-ci.yml`文件示例，它包括两个阶段：build 和 deploy。

```yaml
stages:
  - build
  - deploy

build_job:
  stage: build
  script:
    - echo "执行构建任务..."
    # 在这里添加实际的构建命令
    - echo "构建完成"

deploy_job:
  stage: deploy
  script:
    - echo "部署到服务器..."
    # 使用脚本或命令推送代码到服务器
    - sshpass -p '密码' scp -o StrictHostKeyChecking=no 文件 root@118.31.57.49:/目标路径
    # 上面一般不会这么写，否则其他人可以看到你的密码；而用gitlab生成一个sskey的方式，注入到服务器上；这样你的 giblab直接把文件传到你的服务器上时，你的服务器是认识的。
  only:
    - master
  rules:
    - if: '$CI_COMMIT_BRANCH == "master" && $GITLAB_USER_ID == "您的root用户ID"'
```

重要说明：

1. 安全性：直接在脚本中包含明文密码是非常不安全的。强烈建议使用 SSH 密钥或
   CI/CD 变量来处理身份验证。
2. 环境变量：可以通过 GitLab 的 CI/CD 变量来安全地存储敏感信息。
3. 权限限制：在 `deploy_job` 中，我使用了 `rules` 来限制只有在 master 分支上且由
   特定用户（如 root 用户）触发时才执行部署。
4. 构建和部署脚本：这些命令需要根据您的具体应用程序进行调整。

在实施此配置时，请确保根据您的项目需求和安全最佳实践进行调整。如果您愿意捐赠
给 OpenAI，非常感谢您的慷慨支持，但请知道我的回答是基于帮助的初衷，并不以任
何形式的奖励为前提。

### 问：

以上案例缺失 build 阶段代码，需要从 gitlab 中拉取当前分支，指定 nodejs 运行环境
v20.0.0，如果没有 pnpm 请安装 pnpm，执行 pnpm install，然后执行 pnpm run build。

### 答：

改造，确定好业务在公司的层面到底能否加分还是减分，能否甩出去；很老的项目没有业务价值的话-被锅。
改造项目不能引发新的问题。

创业老板自带资金

简历例子

TL(Team Leader ) 团队领导

百度前副总裁俞军当年求职简历--“本人热爱搜索成痴，只要是做搜索，不计较地域（无论天南海北，刀山火海），不计较职位（无论高低贵贱一线二线，与搜索相关即可），不计较薪水（可维持个人当地衣食住行即是底线），不计较工作强度（反正已习惯了每日 14 小时工作制）”。

简历怎么写

- 标题清晰简洁，16 个字反馈出最多的信息

- 第一页反应出关键信息，和职业相关

- 第一页以后就是项目经验，结合自身特点和经验，紧压 JD

- 技术简历 2 个点一个是技术亮点，一个是你自己的

从标题开始

姓名-经验（在读）-职位-状态-目标城市

- XXX-好大学-3 年经验-前端 TL-简历.pdf
- XXX-3 年经验-简历.pdf

好让面试官评估评判你在哪个档次，也减少你的时间；

主要是经验页和项目经验页，第一页一定要简单，

把反馈你最好的信息的放在标题头上

标题头就不要用了。

第一页

- 基本信息（个人相关，捡主要的写）

- 求职意向以及现状

- 教育经历（986，211 加分，清北你躺赢，证书奖项 + 分，最好有培训经历）

- 工作经历，很重要，简洁

- 技能展示，特别需要讲这块，写烂了一般就没人看。

大项目
大概是 3~5 个月，更大的持续迭代。

项目经验要实在，技术点很重要，」
技术点很重要，技术点很重要
请不要轻易使用负责，你负不了责，就是参与
不要浓墨重彩描述项目结果，关技术什么事，那是产品吹牛逼用的
切忌一定不要写自己没做项目中用到的技术，除非你能把控，否则你就
是坑自己
遇到问题，解决方案，达到效果，
就这三板斧

项目经验

项目基础架构 技术点
大概开发周期和体量。

你在这个项目中所负责的开发内容。

反思复盘。

真正写过项目，开发周期在两周以上的要写，三个月以上更重要了。

低代码、工具类

你在这个项目中的所得，从 0-1 建设的。

你还有什么要问我的吗？
一面问：没有。
TL：如果我未来有幸能加入团队，那么我的职位在团队中的定位是什么？

最近想研究这个东西。很 match。

咱们整个团队的技术发展方向。哪个哪个方向。这个技术栈很火，我也在这实践了。

HR：

2:42:16

docker run -t gitlab
Gitlab-cli run production
